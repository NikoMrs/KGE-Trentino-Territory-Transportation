PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX etype: <http://knowdive.disi.unitn.it/etype#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>

# 7.1 (Francesca): What is the average maximum capacity of public parking spaces within a 1 kmradius of the Department of Medicine at the University of Trento?
# Department of Medicine lat:46.0683824 lon:11.1254334 

SELECT (COUNT(?capacity) AS ?n_of_parking_facilities) (SUM(xsd:float(?capacity)) / COUNT(?capacity) AS ?average_capacity)
WHERE {
    
    # Select all the public parking facilities
    ?parking_facility a etype:Parking_facility;
                       etype:parking_access ?parking_access;
                       etype:capacity ?capacity ;
                       etype:latitude ?latitude ;
                       etype:longitude ?longitude .
	FILTER(STR(?parking_access) = "public")
    
    # Filter all the Parking Facilities by range (~1km) from the wanted position
    FILTER(ABS(xsd:float(?latitude) - 46.0683824) <= 0.01 &&
           ABS(xsd:float(?longitude) - 11.1254334) <= 0.01)
}

PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX etype: <http://knowdive.disi.unitn.it/etype#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>

# 2.2 (Helmut): Which train routes allow bicycle transportation during the weekend?

select ?trip_headsign ?line_name ?days ?bike_slots where {

# PRIMA DOBBIAMO DARE LE RELAZIONI E POI FILTRIAMO IL TUTTO
    
   	# We consider only the Train lines
    ?line etype:line_short_name ?line_name .
    ?line etype:line_type ?line_type .
    FILTER(STR(?line_type) = "2")
    
    # We connect lines and trips
    ?line etype:composed_of ?trip .
         
    # We select only the trips that have bike slots
    ?trip etype:bike_slots ?bike_slots ;
          etype:headsign ?trip_headsign .
    FILTER(STR(?bike_slots) >= "1")
    
    # Selects only the trips available during the weekend
    ?schedule etype:is_followed_by ?trip .
    ?schedule etype:byDay ?days .
    FILTER(CONTAINS(STR(?days), "saturday") || CONTAINS(STR(?days), "sunday"))
    
} GROUP BY ?trip_headsign ?line_name ?days ?bike_slots 